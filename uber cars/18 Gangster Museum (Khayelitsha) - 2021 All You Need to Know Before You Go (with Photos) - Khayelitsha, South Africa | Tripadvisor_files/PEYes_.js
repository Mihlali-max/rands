(this.$WP=this.$WP||[]).push(["PEYes_",(e,t)=>{"use strict";var r,n,a,s,i,l,o,u,c,d,g,v,m,p,f,h,T,E,R,A,O,S,y,k,b,P,I,C,_,L,N,x,j,F,w,D,q,M,U,H,B,G,Q,V,$,K,Y,z,W,J={APS_SSR_ERROR:"fusion-apsError-count",APS_SSR_PARTIAL:"fusion-apsPartial-count",GRAPHQL_SSR_ERROR:"fusion-graphQLError-count"};function Z(e,t){r("global",J[e],t)}var X=(e,t)=>{var{contentType:r="none",geoId:n="none"}=t||{};return`${String(n)}~${String(r)}~${e}`},ee=e=>X("filters",e),te=e=>X("sort",e),re=(e,t)=>{var{filters:r=[]}=e||{},s=ee(e),i=((e,t)=>{var r=(e=>{if(!e)return new Set;var t=a(e),r=null==t?void 0:t.pageParameters.flatMap(e=>"string"!=typeof e.type&&"Filters"===e.type.name?e.type.filters:e).filter(({category:e})=>"CANONICAL"===e).map(e=>e.apiName);return new Set(r||[])})(t);return(null==e?void 0:e.filter(e=>e&&e.id&&!r.has(e.id)))||[]})(r,t);i.length>0?n.set(s,i):n.remove(s)},ne=e=>e&&e.id?{id:e.id,value:(e.value||[]).filter(Boolean)}:null,ae=(e,t)=>{return[...new Map((r=[...e,...t],r.filter(Boolean).map(ne).filter(Boolean)).map(e=>[e.id,e])).values()];var r},se=(e,t)=>{var r=new Map;return e.forEach(e=>r.set(e.id,e)),t.forEach(e=>{var t=r.has(e.id)?r.get(e.id):{id:e.id,value:e.value},n=((e,t,r,n)=>{var a=new Set(t||e||[]);return null==r||r.forEach(e=>a.add(e)),null==n||n.forEach(e=>a.delete(e)),Array.from(a.keys())})(null==t?void 0:t.value,e.value,e.selected,e.deselected);r.set(e.id,{id:e.id,value:n})}),Array.from(r.entries()).map(([,e])=>e)},ie=(e,t)=>{var r=[...e,...t],n=new Map;return r.forEach(e=>{var t,r,a,s=n.get(e.id);n.set(e.id,null!=s?(r=e,{id:(t=s).id,selected:[...new Set([...t.selected||[],...r.selected||[]])],deselected:[...new Set([...t.deselected||[],...r.deselected||[]])],value:((null==(a=r.value)?void 0:a.length)||0)>0?r.value:t.value}):e)}),Array.from(n.entries()).map(([,e])=>e)},le=e=>{var t=e.getFullYear(),r=e.getMonth()+1;r=r<10?"0"+r:r;var n=e.getDate();return`${t}-${r}-${n=n<10?"0"+n:n}`},oe=(e,t)=>{var r=new Date(e);return t&&(r.setHours(t.hour),r.setMinutes(t.minute)),le(r)},ue=e=>{var t;if(null!=(null==e?void 0:e.find(e=>"navbar"===(null==e?void 0:e.id))))return[];var r=null==e?void 0:e.find(e=>"category"===(null==e?void 0:e.id)),n=null==r||null==(t=r.value)?void 0:t[0];return n&&n.length>2?[{id:"navbar",value:[`APLIST:${n}-true`]}]:[]};function ce(e,t,r=!1){return!!t&&(!r||"attraction"!==e&&"attraction_product"!==e?t.filter(Boolean).length>0:t.filter(Boolean).filter(e=>e.id&&!w.has(e.id)).length>0)}var de=e=>{var[{data:t,fetching:r,error:n}]=e;if(!1===r){if(n&&"CombinedError"===n.name)return 503;if(null==t?void 0:t.Result){var{status:a}=t.Result[0];if(!1===a.success||!0===a.partial)return 503}}return 200},ge=({children:e,href:t="#",theme:r="none",target:n="newTabDesktop",trackingDetails:a,accessibilityString:i,onClick:l})=>{var o=g(n),{trackClick:u}=Oe(a),c=s.useCallback(()=>(l&&l(),u(),!0),[l,u]);return s.createElement(d,{target:o,theme:r,onClick:c,href:t,"aria-label":i},e)},ve=({tagName:e="span",content:t})=>{var{localize:r}=A(),n=s.useRef();return s.useEffect(()=>{var e=n.current;if(e){var t=new Set;if([...e.querySelectorAll("*")].map(e=>{[...e.getAttributeNames()].forEach(t=>{("class"!==t||"class"===t&&"strikethrough"!==e.getAttribute(t))&&e.removeAttribute(t)});var t=e.tagName.toUpperCase();return t in q&&q[t](e,r),t}).forEach(e=>{D.has(e)||t.add(e)}),t.size>0){var a=[...t].join(","),s="HtmlString should not contain: "+a;console.error(s),e.dataset.apsUnexpected=a}}},[t,r]),s.createElement(e,{className:"_2tsgCuqy",dangerouslySetInnerHTML:{__html:t},ref:n})},me=e=>{var t,r,n=(null==e||null==(t=e.routeParameters)?void 0:t.pagee)&&parseInt(null==e||null==(r=e.routeParameters)?void 0:r.pagee,10);return n&&!Number.isNaN(n)?n:0},pe=e=>!0===e?"User":!1===e?"Def":"UNKNOWN",fe=e=>{e?T.set(H,e,18e5):T.remove(H)},he={trackingKey:"DEFAULT",trackingTitle:"DEFAULT"},Te=(...e)=>e.map(e=>String(e)).join("-"),Ee=e=>null!=e&&""!==e&&"DEPRECATED"!==e.toUpperCase(),Re=e=>t=>{var{context:r,type:n}=t,{trackingKey:a,trackingTitle:s,clientContext:i,clientParameter:l,scrollDirection:o,userState:u}=r,c={trackingKey:a,trackingTitle:s,clientParameter:l,clientContext:i,userState:u};if(Ee(r.trackingKey))switch(n){case"click":e.logClick(c);break;case"scroll":e.logScroll(Object.assign({},Object.assign({},c,{direction:o})));break;default:console.error("Unexpected event type",t.type,t)}},Ae=()=>{var e=(()=>{var e=v(),t=s.useContext(E),r=s.useMemo(()=>t?(e=>{var t;if(e){var{hotelCommerce:r,attractionCommerce:n,restaurantCommerce:a}=e;if(!(r||n||a))return;var s=e.lastUpdated;r&&(t=Object.assign({},t,{h:{ci:r.checkIn,co:r.checkOut,dt:pe(null==r?void 0:r.setByUser),tt:s}})),n&&(t=Object.assign({},t,{a:{ci:n.startDate,co:n.endDate,dt:pe(null==n?void 0:n.setByUser),tt:s}})),a&&(t=Object.assign({},t,{r:{ci:a.reservationTime?a.reservationTime.split("T")[0]:null,dt:pe(null==a?void 0:a.setByUser),tt:s}}))}return t})(t):void 0,[t]),{sessionId:n}=s.useContext(m),[{path:a}]=s.useContext(p),i=T.get(H),l=s.useMemo(()=>({logClick:t=>(fe(n),!G.exists(Te("click",n,a,t.trackingKey,t.clientContext,t.clientParameter))&&(e({AppPresentation:{click:Object.assign({},t,{sessionId:n,dates:r})}}),!0)),logNewSession(t){fe(n),e({AppPresentation:{newSession:Object.assign({},t,{sessionId:n,dates:r})}})},logScroll:t=>(fe(n),!G.exists(Te("scroll",n,a,t.trackingKey,t.clientContext,t.clientParameter))&&(e({AppPresentation:{sectionScroll:Object.assign({},t,{sessionId:n,dates:r})}}),!0))}),[n,a,e,r]);return s.useEffect(()=>{if(n){var e=T.get(H);e&&e===n||l.logNewSession({sessionId:n,deepLink:a}),fe(n)}else fe(null)},[n,r,a,l,i]),l})(),t=s.useContext(Q);return s.useCallback(t(e),[e,t])},Oe=e=>{var{context:t}=s.useContext(B),r=Ae();return s.useMemo(()=>({trackClick(n){r({type:"click",context:Object.assign({},t,{},e,{},n)})}}),[t,e,r])},Se=({context:e,children:t})=>{var r=Ae(),n=function(e,t=U,r=R){var{timeout:n,threshold:a,rootMargin:i,onceOnly:l}=Object.assign({},U,{},t),[o,u]=s.useState(!1),[c,d]=s.useState(!1);return s.useEffect(()=>{var t;return o&&(t=setTimeout(()=>{c&&l||(e(),d(!0))},n)),()=>{clearTimeout(t)}},[o,c,l,e,n]),r(u,i,a)}(s.useCallback(()=>{r({type:"scroll",context:e})},[r,e]));return n&&s.createElement("span",{"data-ft":!0,ref:n},t)},ye=e=>{var{trackingKey:t,trackingTitle:r,context:n,noVisibility:a=!1,scrollDirection:i=null,children:l}=e,o=s.useMemo(()=>({context:Object.assign({scrollDirection:i,trackingKey:t,trackingTitle:r},n)}),[n,i,t,r]);return Ee(t)?s.createElement(B.Provider,{value:o},a?l:s.createElement(Se,{context:o.context},l)):l},ke=({context:e,impressions:t})=>s.useEffect(()=>{},[e,t]);function be(){var[{page:e,params:t}]=s.useContext(p);return(null==t?void 0:t.contentType)?t.contentType:(e=>(/(hotel|lastminute|showuserreviews|smartdeals)/i.test(e)?"hotel":/^(attraction_product|attractionproductreview)/i.test(e)&&"attraction_product")||/^attraction/i.test(e)&&"attraction"||/^restaurant/i.test(e)&&"restaurant"||null)(e)}var Pe=e=>{var{attractions:t}=e,r={},n=(e=>{var t=[];return null!=e.adults&&e.adults>0&&t.push({ageBand:"ADULT",count:e.adults}),t.length||t.push({ageBand:"ADULT",count:2}),t})(t);return n.length>0&&(r={pax:n}),t.fromDate&&(r=Object.assign({},r,{startDate:le(t.fromDate)})),t.toDate&&(r=Object.assign({},r,{endDate:le(t.toDate)})),t.fromDate&&t.toDate&&(r=Object.assign({},r,{setByUser:!0})),Object.keys(r).length>0?Object.assign({},r):null},Ie=e=>{var{hotels:t}=e;return{checkIn:(null==t?void 0:t.checkInDate)&&!t.defaultDates?le(t.checkInDate):null,checkOut:(null==t?void 0:t.checkOutDate)&&!t.defaultDates?le(t.checkOutDate):null,rooms:(()=>{var e=[];if(t){var{rooms:r,adults:n,children:a,childAgesPerRoom:s}=t;a>0&&(!s||r<s.length)&&console.error("Malformed hotel travel info, rooms vs. childAgesPerRoom",r,s.length,a);for(var i=0,l=0,o=0;o<n;o++)e[i]?e[i]=Object.assign({},e[i],{adults:e[i].adults+1}):(e[i]={adults:1},s[i]&&Array.isArray(s[i])&&s[i].length&&(e[i]=Object.assign({},e[i],{childrenAges:s[i]}),l+=s[i].length)),++i>=r&&(i=0);l!==(a||0)&&console.error(`Hotel info mismatch: totalChildren for ${r} rooms: ${l} != ${a}`,JSON.stringify(s))}return 0===e.length?null:e})(),setByUser:null!==t&&!t.defaultDates||null}},Ce=e=>{var{restaurants:t}=e;return t.date?{partySize:t.guests||1,reservationTime:t.date&&oe(t.date,t.time)}:null};function _e(){var e=function(){var[{page:e,path:t}]=s.useContext(p);return((e,t)=>/\/Hotel_Review-s1-+/i.test(t)?"HotelHighlight":e)(e,t)}(),[,{uid:t}]=s.useContext(p);return s.useMemo(()=>({screenName:e,pageviewUid:t}),[e,t])}var Le=(e,t,r)=>{var{route:n,pageName:a}=e;if(n&&b(a)){var s=Object.assign({},n.params,{},t);if(n.page!==a||!I(n.params,s))return Object.assign({},n,{page:r||a,params:s})}return null},Ne=(e,t)=>{var r=Object.assign({},e,{detailRequest:Object.assign({},e.detailRequest,{routeParameters:Object.assign({},e.detailRequest.routeParameters,{pagee:null})})}),n=Le(e,{offset:null});return n?(t(n,"IN_PLACE"),Object.assign({},r,{navigating:!0})):r},xe=(e,t,r)=>{var a,s,i,l,o,u,c,d,g=(e,t)=>r(e,t||(b(e.page)?"PARAM_UPDATE":"PAGE_VIEW"));switch(t.type){case"reinitialize":var v,m,p=null==(v=e.detailRequest)?void 0:v.routeParameters,f=null==(m=t.newState.detailRequest)?void 0:m.routeParameters;return"detail"===e.screenType&&(null==p?void 0:p.contentId)===(null==f?void 0:f.contentId)&&(null==p?void 0:p.contentType)===(null==f?void 0:f.contentType)?e:t.newState;case"updateRouteParameters":return Object.assign({},e,{listRequest:Object.assign({},e.listRequest,{routeParameters:Object.assign({},e.listRequest.routeParameters,{},t.routeParameters)})});case"setUpdateToken":return Object.assign({},e,{detailRequest:Object.assign({},e.detailRequest,{updateToken:t.updateToken}),listRequest:Object.assign({},e.listRequest,{updateToken:t.updateToken}),updateToken:t.updateToken});case"setFilter":return((e,t,r)=>{var{listRequest:n,pageName:a}=e,{routeParameters:s=null}=n,i=ae((null==s?void 0:s.filters)||[],t);i=i.filter(({value:e})=>null!=e&&0!==e.length&&"REMOVE"!==e[0]);var l=a;if("AttractionsFusion"===a||"AttractionProductsFusion"===a){var o,u,c,d,g=t.find(e=>"navbar"===e.id),v=t.find(e=>"category"===e.id),m=null==v||null==(o=v.value)?void 0:o[0],p=null==s||null==(u=s.filters)||null==(c=u.find(e=>"category"===(null==e?void 0:e.id)))||null==(d=c.value)?void 0:d[0];if(g){var f,h=(null==(f=g.value)?void 0:f[0])||"",[,T,E,R]=h.match(/^(ATTRACTIONOVERVIEW|APLIST):(\d*)-(true|false)/)||[];"false"===R&&("ATTRACTIONOVERVIEW"===T?(l="AttractionsFusion",i=E&&""!==E?[{id:"category",value:[E]}]:[F]):"APLIST"===T&&(l="AttractionsFusion","11867"===E?i=E&&""!==E?[{id:"category",value:["63"]}]:[]:"12024"===E&&(i=E&&""!==E?[{id:"category",value:["41"]}]:[])))}else v&&m!==p&&(i=[v]);i=i.filter(({id:e})=>"navbar"!==e)}var A=Object.assign({},n.routeParameters,{filters:[...i,...ue(i)],pagee:void 0}),O=Object.assign({},e,{listRequest:Object.assign({},e.listRequest,{routeParameters:A})});re(A,l);var S=Le(e,A,"HotelsListFusion"===l?"HotelsFusion":null);return S?(r(S),Object.assign({},O,{navigating:!0})):O})(e,t.filters,g);case"updateReviewFilters":return Ne(Object.assign({},e,{detailRequest:Object.assign({},e.detailRequest,{updateToken:null,clientState:{userInput:(c=(null==(a=e.detailRequest.clientState)?void 0:a.userInput)||[],d=t.filters,[...d,...c].filter((e,t,r)=>t===r.findIndex(t=>(null==t?void 0:t.inputKey)===(null==e?void 0:e.inputKey))))}})}),g);case"removeReviewFilters":return Ne(Object.assign({},e,{detailRequest:Object.assign({},e.detailRequest,{clientState:{userInput:(o=t.filtersToRemove,u=(null==(s=e.detailRequest.clientState)?void 0:s.userInput)||[],o.findIndex(e=>e&&"*"===e)>=0?[]:u.filter(e=>!o.includes(null==e?void 0:e.inputKey)))}})}),g);case"resetReviewFilters":return Ne(Object.assign({},e,{detailRequest:Object.assign({},e.detailRequest,{clientState:{userInput:[]}})}),g);case"paginate":return((e,t,r)=>{var n,a=0!==t?String(t):null,s=((e,t)=>{var r,n,{listRequest:a,pageName:s}=e,{routeParameters:i=null}=a,l=null==i?void 0:i.filters;return"AttractionsFusion"===s&&(l=(null==i||null==(r=i.filters)?void 0:r.length)||null!=t?null==i||null==(n=i.filters)?void 0:n.filter(e=>"allAttractions"!==(null==e?void 0:e.id)):[F]),l})(e,a),i=null==(n=e.listRequest.routeParameters)?void 0:n.sort,l=Le(e,{pagee:a,sort:i,filters:s});return l?(r(l),Object.assign({},e,{navigating:!0})):e})(e,t.offset,g);case"setSort":return((e,t,r)=>{var a,s=Object.assign({},null==e||null==(a=e.listRequest)?void 0:a.routeParameters,{sort:t,pagee:void 0}),i=Object.assign({},e,{listRequest:Object.assign({},e.listRequest,{routeParameters:s})});(e=>{var t=te(e),r=e.sort||null,a=e.sortOrder||null;null!==r?n.set(t,{sort:r,sortOrder:a}):n.remove(t)})(i.listRequest.routeParameters);var l=Le(e,s);return l?(r(l),Object.assign({},i,{navigating:!0})):i})(e,t.sort,g);case"setAttractionsDates":return Object.assign({},e,{commerce:Object.assign({},e.commerce,{attractionCommerce:Object.assign({},null==(i=e.commerce)?void 0:i.attractionCommerce,{startDate:le(t.startDate),endDate:le(t.endDate),setByUser:t.setByUser})})});case"resetAttractionsDates":return Object.assign({},e,{commerce:Object.assign({},e.commerce,{attractionCommerce:{startDate:null,endDate:null}})});case"setAttractionsPax":return Object.assign({},e,{commerce:Object.assign({},e.commerce,{attractionCommerce:Object.assign({},null==(l=e.commerce)?void 0:l.attractionCommerce,{pax:t.pax})})});case"resetFilters":return((e,t)=>{var r,{listRequest:n,pageName:a}=e,s=[];"AttractionsFusion"===e.pageName&&0===((null==(r=s)?void 0:r.length)||0)&&(s=[F]);var i=Object.assign({},n.routeParameters,{filters:s,pagee:void 0}),l=Object.assign({},e,{listRequest:Object.assign({},e.listRequest,{routeParameters:i})});if(re(i,a),t){var o=Le(e,i);if(o)return t(o),Object.assign({},l,{navigating:!0})}return l})(e,t.noNavigate?null:g);default:return console.error("Unhandled action",t.type),e}},je={screenType:"list",contentType:null,pageName:null,listRequest:{},detailRequest:{},commerce:null,sessionId:null,currentGeoPoint:null,tracking:null,updateToken:null,route:null,navigating:!0},Fe=()=>s.useContext(K),we=({children:e})=>{S(),y();var[t,r]=function(){var e=s.useContext(p),t=s.useContext(f),r=s.useContext(m),i=function(){var[{page:e}]=s.useContext(p);return $.list.includes(e)?"list":$.detail.includes(e)?"detail":(console.error("Unknown mapping for",e,"assuming 'list'"),"list")}(),[l,{navigate:o}]=e,u=be(),c=function(){var e=s.useContext(f),t=be();return s.useMemo(()=>"hotel"===t?{hotelCommerce:Ie(e)}:"attraction"===t||"attraction_product"===t?{attractionCommerce:Pe(e)}:"restaurant"===t?{restaurantCommerce:Ce(e)}:null,[t,e])}(),{page:d}=l,g=C()?"MILES":"KILOMETERS",{sessionId:v}=r,{preferences:{currency:h}}=t,T=_e(),E=function(){var[{params:e,page:t}]=s.useContext(p),r=be(),i=_e(),l=(()=>{var e,t,r=L(),[{params:n,page:a}]=s.useContext(p),i=null!=n.geoId?n.geoId:void 0,l=null!=n.contentId?parseInt(n.contentId,10):0,o=s.useMemo(()=>({query:V,variables:{contentId:l},pause:!r||"HotelsListFusion"!==a||null!=i&&i>0||0===l}),[r,a,i,l]),[{data:u,fetching:c,error:d}]=_(o);return null!=i&&i>0||c||d?i:null==u||null==(e=u.result)||null==(t=e[0])?void 0:t.geoId})();return s.useMemo(()=>{var s,o,u,c={tracking:i},d=!1;if(b(t)){var g,v=(e=>{var t,r,n=(r=null==(t=a("AppList"))?void 0:t.pageParameters.map(e=>e.apiName),new Set(r||[])),s={};return Object.entries(e||{}).forEach(([e,t])=>{n.has(e)&&(s[e]=t)}),s})(e);d=((null==v||null==(g=v.filters)?void 0:g.length)||0)>0,u=Object.assign({geoId:l},v)}else{var{offset:m}=e;d=Object.keys(e).length>1;var{filters:p,pagee:f}=d?{pagee:m?String(m):"0",filters:[]}:{};u={contentType:r,filters:p,geoId:l,pagee:f}}return u=d?(e=>{var t=(e=>n.get(te(e))||null)(e);return t?Object.assign({},e,{sort:e.sort||t.sort,sortOrder:e.sort||t.sort}):e})(u):u,(e=>{var{routeParameters:t}=e;if(t){var r=(e=>n.get(ee(e))||[])(t),{filters:a}=t;if(r&&a)return Object.assign({},e,{routeParameters:Object.assign({},t,{filters:ae(r,a)})})}return e})(Object.assign({},c,{routeParameters:Object.assign({},u,{filters:[...(null==(s=u)?void 0:s.filters)||[],..."attraction"===r?ue(null==(o=u)?void 0:o.filters):[]]})}))},[r,t,e,i,l])}(),R=function(){var e,[{params:t}]=s.useContext(p),r=_e(),n=be(),a=null;return t.contentId?a=t.contentId:t.detailId&&(a=String(t.detailId)),t.offset&&(e=String(t.offset).replace(/[^0-9]/g,"")),s.useMemo(()=>({tracking:r,routeParameters:{contentType:n,contentId:a,pagee:e}}),[r,n,a,e])}(),A=s.useMemo(()=>({screenType:i,contentType:u,pageName:d,commerce:c,listRequest:E,detailRequest:R,currency:h,unitLength:g,sessionId:v,tracking:T,currentGeoPoint:null,route:l,navigating:!1}),[i,u,d,c,E,R,h,g,v,T,null,l]),[O,S]=s.useState(A);s.useEffect(()=>{S(e=>xe(e,{type:"reinitialize",newState:A},()=>{}))},[A]);var y=s.useCallback(e=>{S(t=>xe(t,e,o))},[o]);return s.useMemo(()=>[O,y],[O,y])}(),i=s.useMemo(()=>({state:t,dispatch:r}),[t,r]);return s.createElement(K.Provider,{value:i},s.createElement(k,{includeWebSiteSchema:!0}),s.createElement(P,null,e,s.createElement(O,null)))},De=()=>{var{dispatch:e}=Fe();return t=>{e({type:"setFilter",filters:t})}};function qe(){var{viewportCategory:e}=i(h);return l(()=>({value:e,mobile:"MOBILE"===e,tablet:"TABLET"===e,desktop:"DESKTOP"===e,tabletOrSmaller:"MOBILE"===e||"TABLET"===e,tabletOrLarger:"TABLET"===e||"DESKTOP"===e}),[e])}function Me(e,t=!0){if(e){var r=!!e.networkError,n=e.graphQLErrors&&e.graphQLErrors.length>0,a={networkError:r,graphQLError:n,anyError:r||n,toString:()=>e?function(e){var{networkError:t,graphQLErrors:r}=e,n=new Map;if(t){var{name:a,message:s}=t;n.set(`${a}: ${s}`,1)}return r&&r.forEach(e=>{var t;if("string"==typeof e)t="GraphQLError: "+e;else{var{name:r,message:a}=e;t=`${r}: ${a}`}var s=n.get(t);s?n.set(t,s+1):n.set(t,1)}),[...n.entries()].map(([e,t])=>`${e} (${t} times)`).join("\n")}(e):null};return t&&a.anyError&&Z("GRAPHQL_SSR_ERROR",1),a}return{networkError:!1,graphQLError:!1,anyError:!1}}function Ue(e){var t,r,n,a,[i,l]=s.useState(null),o=s.useRef([]),{current:u}=o,[c,d]=s.useMemo(()=>{var{query:t,variables:r,pause:n}=e,{pollInterval:a,updateToken:s,lastQuery:l}=i||{},u=I(r,l),c=null==r?void 0:r.request;return c&&a&&a>0&&s&&u?(s.substr(-20),[{query:t,variables:Object.assign({},r,{request:Object.assign({},c,{updateToken:s})}),pause:n},!0]):(o.current=[],[e,!1])},[e,i]),[g,v]=x(c,de),m=Array.isArray(null==g||null==(t=g.data)?void 0:t.Result)?g.data.Result[0]:null==(r=g.data)?void 0:r.Result;s.useEffect(()=>{var t,r;!1===(null==m||null==(t=m.status)?void 0:t.success)&&console.error("[useAPSQuery] query failure",null==m||null==(r=m.status)?void 0:r.message);var{pollingStatus:n=null}=(null==m?void 0:m.status)||{},{delayForNextPollInMillis:a=null,updateToken:s=null}=n||{},o=a||1e3;o&&o<1e3&&(o=1e3);var u,c={lastQuery:Object.assign({},e.variables),pollInterval:a,updateToken:s};return a&&a>0&&c&&!I(c,i)&&(u=setTimeout(()=>{l(c)},o)),()=>{u&&clearTimeout(u)}},[o,m,i,e,d]);var p=!(null==m||null==(n=m.status)||null==(a=n.pollingStatus)?void 0:a.updateToken);return s.useMemo(()=>{var{data:e,fetching:t,error:r}=g;if(d&&!t&&!r&&e){o.current=((e,t)=>{var r,n;if(!t)return e;var a=null==t||null==(r=t.Result)?void 0:r[0];if(!a)return e;if(!e||0===e.length)return a.sections;var{updatedClusterIds:s}=a;if(!s)return e;var i=[];e.forEach(e=>{var t={section:e,next:null},r={head:t,tail:t};i.push(r)});var l,o,u=(l=e,o=new Map,l.forEach((e,t)=>{if(e){var r=o.get(e.clusterId)||[];r.push(t),o.set(e.clusterId,r)}}),o),c=new Map,d=i[i.length-1];null==(n=a.sections)||n.forEach(e=>{var t={section:e,next:null},r=u.get(e.clusterId);if(null==r||0===r.length){var n=c.get(e.clusterId);n?(n.tail.next=t,n.tail=t,d=n):(d.tail.next=t,d.tail=t)}else{var a=r.shift(),s={head:t,tail:t};i[a]=s,d=s,c.set(e.clusterId,s)}}),s.filter(Boolean).forEach(t=>{var r;null==(r=u.get(t))||r.forEach(t=>{var r,n;t===e.length-1&&null!==(null==(r=i[t].head)?void 0:r.next)&&void 0!==(null==(n=i[t].head)?void 0:n.next)?i[t].head=i[t].head.next:i[t].head=null})});var g=[];return i.forEach(e=>{for(var t=e.head;null!=t;)g.push(t.section),t=t.next}),g})(o.current,e)||[];var n=((e,t)=>{if(e&&e.Result&&t){var r,n=null==(r=e.Result)?void 0:r[0];if(n)return Object.assign({},e,{Result:[Object.assign({},n,{sections:t})]})}return e})(e,u);if(n)return[{data:Object.assign({},e,{},n),fetching:t,error:r,polling:d&&!p},v]}return[{data:e,fetching:t&&!d,polling:d&&!p,error:r},v]},[u,d,p,g,v])}function He(e){var{shouldPoll:t}=e;return function(e){var[r,n]=o(0),a=x(e),s=u(()=>{n(r+1)},[r]),[{error:i}]=a;return Me(i),c(()=>{n(0)},[e]),c(()=>{var[{data:e,fetching:n},i]=a;if(!n){var{poll:l,delay:o}=t(e,r);if(l&&o>0){var u=Math.max(o,300);setTimeout(()=>{i({requestPolicy:"cache-and-network"}),s()},Math.max(u,300))}}return()=>{}},[e,a,s,r]),a}}var Be={INFO:{alertLevel:"primary",log:e=>{}},WARNING:{alertLevel:"warning",log:e=>console.warn("[Fusion/APSUnexpected]",e)},ERROR:{alertLevel:"danger",log:e=>console.error("[Fusion/APSUnexpected]",e)}},Ge=({message:e,level:t="ERROR"})=>{var r=L(),n=Be[t]||Be.ERROR;return c(()=>{var a=`${t}~${e}`;r&&e&&!Y.has(a)&&n.log(e),Y.add(a)},[t,e,n,r]),null},Qe=({queryName:e,urqlError:t,apsStatus:r,emptyResponse:n,fetching:a,children:i})=>{var l,o,u,c=!1,d=n&&!a;if(d||t){var g=d?" is empty":"",v=t?" with error: "+(u=[],(null==(l=t)||null==(o=l.networkError)?void 0:o.message)&&u.push("[Network] "+l.networkError.message),(null==l?void 0:l.graphQLErrors.length)>0&&u.push(`[GraphQL] ${l.graphQLErrors[0].message.replace(/Error #[0-9]+/g,"Error #xxx")}${l.graphQLErrors.length>1?"...":""}`),u.join(" ")):"";console.error("[Fusion] GraphQL error for "+e,`GraphQL response${g}${v}`),c=d}if(!a){if(!1===(null==r?void 0:r.success)){var m=(null==r?void 0:r.message)?" with message: "+(null==r?void 0:r.message):"";console.error("[Fusion] APS error for "+e,m)}null==r||r.partial}return c?s.createElement("div",null,s.createElement(N,null,s.createElement(j,null)),i):i},Ve=e=>null==e,$e=e=>{if(Ve(e))throw new Error("[Fusion] Unexpected null/undefined filter value: "+String(e));var t=Number(e);if(isNaN(t))throw new Error("[Fusion] Bad number value: "+String(e));return t};function Ke(e){var t=[];return Ve(e)||null==e||e.forEach(e=>{null!=e&&t.push(e)}),t}var Ye=({typename:e})=>s.createElement(Ge,{message:"Unsupported type: "+String(e)});function ze(e,t){return I(e,t)}function We(e){return s.memo(e,ze)}var Je={nullCheck:"none",trackVisible:!0,memoize:!1};function Ze(e,t){var r,{trackVisible:n,nullCheck:a="error",extraContext:i,whenNull:l,memoize:o}=Object.assign({},Je,{},t),u=o?We(e):e,c=function(e){var{model:t}=e;if(null==t&&"none"!==a){try{console[a]("[Fusion/NullCheck] unexpected null model")}catch(e){console.error("[Fusion]",e)}if(l)return l()}var r,{trackingKey:o,trackingTitle:c}=(null==(r=e.model)?void 0:r.trackingKey)?{trackingKey:r.trackingKey,trackingTitle:r.trackingTitle}:{trackingKey:null,trackingTitle:null},d=s.createElement(u,e);return Ee(o)?s.createElement(ye,{trackingKey:o,trackingTitle:c||"DEFAULT",context:i,noVisibility:!1===n},d):d};return c.displayName=`Fused(${r=e,r.displayName||r.name||"Component"})`,c}function Xe(e,t=!0,r){return Ze(e,{trackVisible:t,extraContext:r,memoize:!0})}function et(e,t=!0,r){return Xe(e,t,r)}function tt(e,t){var r=()=>s.createElement("div",null,t&&t.map((t,r)=>s.createElement("div",{key:r},s.createElement(e,{model:t}),s.createElement("hr",null))));return r.displayName="APSStory",r}return e({APSStory:tt,FusionComponent:et,apsMemo:We,createUseAPSPollingQuery:He,fuse:Xe,fused:Ze,hasFilters:ce,logFusionSsrMetric:Z,removeNulls:Ke,useAPSQuery:Ue,useAnalyzeError:Me,useContentType:be,useViewportCategory:qe}),[()=>{var t;F={id:"allAttractions",value:["true"]},w=new Set(["allAttractions","attractionType"]),D=new Set(["B","BR","I","U","S","EM","STRONG","SPAN"]),q={S(e,t){Object.assign(e.dataset,{strikethroughStart:t("fusion_strikethrough_start"),strikethroughEnd:t("fusion_strikethrough_end")})},SPAN(e,t){if(e.classList.contains("strikethrough")){var r=e.innerHTML,n=e.ownerDocument.createElement("s");n.innerHTML=r,this.S(n,t),e.innerHTML="",e.appendChild(n)}}},M=s.memo(ve),U={rootMargin:0,threshold:0,timeout:500,onceOnly:!0},H="APS_SESSION_1.1",B=s.createContext({context:he}),t=new Set,G={exists(e){var r=t.has(e);return r||(t.add(e),setTimeout(()=>{t.delete(e)},5e3)),r},reset(){t.clear()}},Q=s.createContext(Re),(V=JSON.parse('{"kind":"Document","definitions":[{"kind":"OperationDefinition","operation":"query","name":{"kind":"Name","value":"BlenderGeoIdQuery"},"variableDefinitions":[{"kind":"VariableDefinition","variable":{"kind":"Variable","name":{"kind":"Name","value":"contentId"}},"type":{"kind":"NonNullType","type":{"kind":"NamedType","name":{"kind":"Name","value":"Int"}}},"directives":[]}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","alias":{"kind":"Name","value":"result"},"name":{"kind":"Name","value":"SeoMetaData_getBlenderData"},"arguments":[{"kind":"Argument","name":{"kind":"Name","value":"request"},"value":{"kind":"ListValue","values":[{"kind":"Variable","name":{"kind":"Name","value":"contentId"}}]}}],"directives":[],"selectionSet":{"kind":"SelectionSet","selections":[{"kind":"Field","name":{"kind":"Name","value":"geoId"},"arguments":[],"directives":[]}]}}]}}],"loc":{"start":0,"end":130}}')).__key=32025661472868,V.loc.source={body:"1d208e2d0064"},$={list:["Hotels","HotelsFusion","HotelsList","HotelsListFusion","HotelsNear","Attractions","AttractionsFusion","Attraction_Products","AttractionProductsFusion","Restaurants","RestaurantsFusion"],detail:["Hotel_Review","Hotel_ReviewFusion","Restaurant_Review","Restaurant_ReviewFusion","Attraction_Review","Attraction_ReviewFusion","AttractionProductReview","AttractionProductReviewFusion"]},K=s.createContext({state:je,dispatch:()=>{}}),Y=new Set,z=s.createContext(!1),W=s.createContext({donePolling:!1}),e("default",null),e({ALL_ATTRACTIONS_CATEGORY_FILTER_VALUE:"ALL",APSStory:tt,APSUnexpected:Ge,APSUnsupportedType:Ye,ATTRACTIONS_CATEGORY_DAY_TRIPS:"63",CONTENT_TYPE_ATTRACTION:"attraction",CONTENT_TYPE_ATTRACTION_PRODUCT:"attraction_product",CONTENT_TYPE_HOTEL:"hotel",CONTENT_TYPE_RESTAURANT:"restaurant",CheckAPSQueryResponse:Qe,Entrypoint:we,FILTER_ATTRACTIONS_ALL_ID:"allAttractions",FILTER_ATTRACTIONS_CATEGORY_ID:"category",FILTER_ATTRACTIONS_L1_CATEGORY_ID:"navbar",FILTER_ATTRACTIONS_SUPPLIER_TOGGLE_ID:"attractionType",FusionComponent:et,FusionTrackedLink:ge,HtmlString:M,ISODateString:le,ISOTimeString:oe,LoadingContext:z,PAGE_ATTRACTION_DETAIL:"Attraction_ReviewFusion",PAGE_ATTRACTION_LIST:"AttractionsFusion",PAGE_ATTRACTION_PRODUCT_DETAIL:"AttractionProductReviewFusion",PAGE_ATTRACTION_PRODUCT_LIST:"AttractionProductsFusion",PAGE_HOTELS:"HotelsFusion",PAGE_HOTELS_LIST:"HotelsListFusion",PAGE_HOTEL_DETAIL:"Hotel_ReviewFusion",PAGE_RESTAURANT_DETAIL:"Restaurant_ReviewFusion",PAGE_RESTAURANT_LIST:"RestaurantsFusion",PollingContext:W,REMOVE_FLAG:"REMOVE",applyFilterChangeList:se,apsMemo:We,createUseAPSPollingQuery:He,fuse:Xe,fused:Ze,getPageeOffsetValue:me,hasFilters:ce,isNullOrUndefined:Ve,logFusionSsrMetric:Z,mergeFilterChangeLists:ie,removeNulls:Ke,responseStatusCheck:de,stringToNumber:$e,unionFilters:ae,useAPSQuery:Ue,useAnalyzeError:Me,useConsoleLogImpressions:ke,useContentType:be,useEntrypointContext:Fe,useSetFilter:De,useTracking:Oe,useViewportCategory:qe})},[e=>r=e.logSsrMetric,e=>n=e.default,e=>a=e.getPageDefForPage,e=>(s=e,i=e.useContext,l=e.useMemo,o=e.useState,u=e.useCallback,c=e.useEffect),e=>d=e.default,e=>g=e.useLinkTarget,e=>v=e.useInteractionLogger,e=>(m=e.Visitor,p=e.Route,f=e.TravelInfo,h=e.Device),e=>T=e.default,e=>E=e.default,e=>R=e.useVisibleEffect,e=>A=e.useLocalize,e=>O=e.default,e=>S=e.usePageViewMoniker,e=>y=e.useBounceRateTracking,e=>k=e.OrganizationJsonLd,e=>(b=e.isFusionPage,P=e.FusionAbTestingProvider),e=>I=e.default,e=>C=e.useIsMiles,e=>_=e.useQuery,e=>(L=e.useIsRobotSafe,N=e.MountedClientOnly),e=>x=e.useQueryRequiredSsr,e=>j=e.default]]},["B7vHz6","qKFflQ","F8raOV","cDcdfi","5KqyYa","mGAIj_","fsml46","2R4xv2","jaCyxS","Bw227B","BLrxBS","0DsHEV","P5nZ8I","jb_4W2","mxARhC","nPqO2d","DY6uxn","YwNsO_","-qDq4b","5X2em-","4Z07E2","OnmvvE","glH5KG"]]);
