<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="ROBOTS" content="NOINDEX, NOFOLLOW">
</head>
<body>
  <script src="facebook_tv-v21931528601a_data/547333922434412.js" async=""></script><script async="" src="facebook_tv-v21931528601a_data/fbevents.js"></script><script type="text/javascript">
    // Pull params from URL (argdict maps keys to values or arrays of values)
    var argdict = {};
    var args = window.location.hash.substring(1).split("&");
    for (var i = 0; i < args.length; i++) {
      var pair = args[i].split("=");

      if (typeof argdict[pair[0]] === "undefined") {
        argdict[pair[0]] = pair[1];
      } else if (typeof argdict[pair[0]] === "string") {
        argdict[pair[0]] = [argdict[pair[0]], pair[1]];
      } else {
        argdict[pair[0]].push(pair[1]);
      }
    }

    // Determine pixel type.
    var fbPixelName = null;
    var isStandardEvent = true;
    if (argdict.pixelType === 'PAGEVIEW') {
      fbPixelName = 'PageView';
    }
    else if (argdict.pixelType === 'SAVE_TO_TRIP_INTENT') {
      fbPixelName = 'SavesIntent';
      isStandardEvent = false;
    }
    else if (argdict.pixelType === 'SAVE_TO_TRIP') {
      fbPixelName = 'SavesCompleted';
      isStandardEvent = false;
    }


    if (fbPixelName !== null) {
      var fbContentType = '["hotel","destination"]';
      var applicationId = encodeURIComponent(250701451714610);
      // event name for Dynamic Product Ads
      var eventName = encodeURIComponent(fbPixelName);
      var fbCategory = encodeURIComponent(argdict.fbTrueServlet);
      var servlet = encodeURIComponent(argdict.trueServlet);
      var fbDevice = encodeURIComponent(argdict.fbDevice);
      var fbDateIn = encodeURIComponent(argdict.fbDateIn);
      var fbDateOut = encodeURIComponent(argdict.fbDateOut);
      var geoId = encodeURIComponent(argdict.geoId);
      var propId = encodeURIComponent(argdict.propId);
      var brandName = encodeURIComponent(argdict.brandName);
      var mcid = encodeURIComponent(argdict.mcid);
      var countryID = encodeURIComponent(argdict.countryID);
      var fbUserUnique = encodeURIComponent(argdict.fbUserUnique);
      var userUnique = encodeURIComponent(argdict.userUnique);
      var ulbBucket = encodeURIComponent(argdict.facebookUlbBucket);
      var ulbScore = encodeURIComponent(argdict.facebookUlbScore);
      var fbRegion = encodeURIComponent(argdict.regionName);
      var fbCity = encodeURIComponent(argdict.cityName);
      var fbCountry = encodeURIComponent(argdict.countryName);
      var fbDestinationName = encodeURIComponent(argdict.destinationName);
      var fbOrigin = encodeURIComponent(argdict.originName);
      var fbLocationType = encodeURIComponent(argdict.locationType);
      var fbRetargetingType = encodeURIComponent(argdict.fbRetargetingType);
      var fbUlbMultiplier = encodeURIComponent(argdict.fbUlbMultiplier);
      var ibFlowStep = encodeURIComponent(argdict.ibFlowStep);
      var viatorTourDate = encodeURIComponent(argdict.attractionTourDate);
      var viatorProductCode = encodeURIComponent(argdict.attractionProductCode);
      var dmpAudienceIds = encodeURIComponent(argdict.dmpAudienceIds);
      var userOrigin = encodeURIComponent(argdict.userOrigin);
      var isLoggedIn = encodeURIComponent(argdict.isLoggedIn);
      var currency = encodeURIComponent(argdict.currency);
      var flightOrigin = encodeURIComponent(argdict.flight_originid);
      var flightDestination = encodeURIComponent(argdict.flight_destid);
      var flightDeparture = encodeURIComponent(argdict.flight_startdate);
      var flightReturn = encodeURIComponent(argdict.flight_enddate);
      var flightOneWay = encodeURIComponent(argdict.flight_oneway);
      var rentalCarPickupLocation = encodeURIComponent(argdict.rc_pu_loc);
      var rentalCarPickup = encodeURIComponent(argdict.rc_pu_date);
      var rentalCarDropoff = encodeURIComponent(argdict.rc_do_date);
      var attractionDateFrom = encodeURIComponent(argdict.attractionDateFrom);
      var attractionDateTo = encodeURIComponent(argdict.attractionDateTo);
      var locationHierarchy = encodeURIComponent(argdict.locationHierarchy);

      // Only one model will be calculated for each user - v2, v2.1, or complex
      var uvmV2Bucket;
      var uvmV2Score;
      if (argdict.hasOwnProperty('facebookuvm_complexUlbBucket') && argdict.hasOwnProperty('facebookuvm_complexUlbScore')) {
        uvmV2Bucket = argdict.facebookuvm_complexUlbBucket;
        uvmV2Score = argdict.facebookuvm_complexUlbScore;
      }
      else if (argdict.hasOwnProperty('facebookuvm_v2.1UlbBucket') && argdict.hasOwnProperty('facebookuvm_v2.1UlbScore')) {
        uvmV2Bucket = argdict['facebookuvm_v2.1UlbBucket'];
        uvmV2Score = argdict['facebookuvm_v2.1UlbScore'];
      }
      else {
        uvmV2Bucket = argdict.facebookuvm_v2UlbBucket;
        uvmV2Score = argdict.facebookuvm_v2UlbScore;
      }
      uvmV2Bucket = encodeURIComponent(uvmV2Bucket);
      uvmV2Score = encodeURIComponent(uvmV2Score);

      var dateIn = argdict.dateIn;
      var dateOut = argdict.dateOut;

      // product ids for Dynamic Product Ads. Currently returning a property product followed by a geo product to ensure the geo product is the last product fired
      var productIds = [];
      if (typeof argdict['loc1'] !== 'undefined') {
        // On Hotels page, loc1 is the top commerce hotel for the geo in the POS.
        // On properties page, loc1 is the actual hotel.
        // In all other pages(e.g. SmartDeals page), loc1 is the top pop hotel of the geo.
        productIds.push(encodeURIComponent('d' + argdict['loc1'] + argdict.locale.replace('_', '')));
      }
      productIds.push(encodeURIComponent(geoId + argdict.locale.replace('_' , '')));
      // For obfuscated pixel key mapping, see FB_PIXEL_KEY_MAPPING in PageMoniker.java
      // These are used for Facebook DPA ad creation, do not modify without consulting vwang@ or om-fb@
      var params = {
        'application_id' : applicationId,
        'content_type' : fbContentType,
        'content_ids' : productIds,
        'region' : fbRegion,
        'city' : fbCity,
        'country' : fbCountry,
        'origin' : fbOrigin,
        'destination' : fbDestinationName,
        'types' : fbLocationType,
        'external_id': fbUserUnique,
        'page_type' : servlet,
        'user_origin' : userOrigin,
        'currency' : currency,
        'origin_airport' : flightOrigin,                        // airport code
        'destination_airport' : flightDestination,              // airport code
        'flight_departure' : flightDeparture,
        'flight_return' : flightReturn,
        'flight_one_way' : flightOneWay,
        'rental_car_pickup_location' : rentalCarPickupLocation,
        'rental_car_pickup' : rentalCarPickup,
        'rental_car_dropoff' : rentalCarDropoff,
        'attraction_start' : attractionDateFrom,
        'attraction_end' : attractionDateTo,
        'FB1' : fbDateIn,           // fbCheckInDate
        'FB2' : fbDateOut,          // fbCheckOutDate
        'FB3' : geoId,              // destinationCode
        'FB4' : fbDevice,           // fbDevice
        'FB5' : countryID,          // IP country id
        'FB6' : locationHierarchy,  // location id hierarchy
        'FB7' : mcid,               // mcid
        'FB8' : fbCategory,         // fbProductType
        'FB9' : propId,             // propertyID
        'FB10': userUnique,         // userUnique - this is passed so Facebook can match users with data we provided in an offline file (5/13/15)
        'FB11': brandName,         // brand
        'FB12': isLoggedIn,         // Logged in (Y or N)
        'FB13': ulbBucket,          // User level bid bucket (UVM v1)
        'FB14': ulbScore,           // User level bid score (UVM v1)
        'FB15': viatorTourDate,     // Viator tour date
        'FB16': viatorProductCode,  // Viator product code
        'FB17': fbRetargetingType,  // Retargeting type
        'FB18': fbUlbMultiplier,    // User level bid multiplier
        'FB27': uvmV2Bucket,        // ULB bucket for v2 (for testing)
        'FB28': uvmV2Score,         // ULB score for v2 (for testing)
        'FB29': dmpAudienceIds,     // The audience ids for the user according to our DMP
        'user_bucket': uvmV2Bucket  // Parameter for FB's new ULB product
      };

      params.checkin_date = dateIn;
      params.checkout_date = dateOut;

      //The following code is copy pasted from facebook.
      !function(f,b,e,v,n,t,s)
      {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
      n.callMethod.apply(n,arguments):n.queue.push(arguments)};
      if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
      n.queue=[];t=b.createElement(e);t.async=!0;
      t.src=v;s=b.getElementsByTagName(e)[0];
      s.parentNode.insertBefore(t,s)}(window, document,'script',
      'https://connect.facebook.net/en_US/fbevents.js');
      // End of copy paste from facebook.

      // Note: Using a variable for the pixel id instead of passing it directly causes FB's pixel helper chrome plug-in to break
      if (typeof argdict['fbHEml'] !== 'undefined') {
        fbq('init', '547333922434412', {em: encodeURIComponent(argdict.fbHEml)});
      }
      else {
        fbq('init', '547333922434412');
      }

      if (isStandardEvent) {
        fbq('track', eventName, params);
      } else {
        fbq('trackCustom', eventName, params);
      }
    }
  </script>


</body></html>